{"mappings":"iiBAAA,IAAAA,EAAAC,EAAA,S,oDAAAC,QAAQC,IAAI,UAUZ,IAAMC,EAAM,qCACNC,EAAW,2BAEXC,EAAUC,SAASC,cAAc,YACjCC,EAAQF,SAASC,cAAc,SAClBD,SAASC,cAAc,gBAI/BE,iBAAiB,UAoC5B,SAAsBC,GACpBA,EAAEC,iBA8EFN,EAAQO,UAAY,GACpBC,EAAO,EA7EP,IAAMC,EAAgBN,EAAMO,MAAMC,OAElCC,EAASH,EAAeD,GAAMK,MAAK,SAAAC,GACjC,GAAsB,KAAlBL,GAA6C,IAArBK,EAAOC,UACjC,OAAOC,EAAAC,GAASC,OAAOC,QACrB,4EAGFH,EAAAC,GAASC,OAAOE,QAAQ,oBAAqCC,OAAjBP,EAAOC,UAAU,aAC7DO,EAAoBR,EAAOS,MAG3BC,EAAsBC,S,OAhD5B,IAAMD,EAAwB,IAAIR,EAAAU,GAAJ,CAAmB,aAAc,CAC7DC,aAAc,MACdC,gBAAiB,SACjBC,aAAc,IACdC,iBAAkB,EAElBC,eAAgB,GAChBC,UAAW,MAITxB,EAAO,E,SAIII,EAASqB,EAAYC,G,OAArBC,EAAQC,MAAAC,KAAAC,U,UAARH,I,OAAAA,EAAfnB,EAAAtB,EAAA,CAAAsB,EAAAuB,GAAAC,MAAA,SAAAC,EAAwBR,EAAYC,G,IAE1BQ,EAGA5B,E,2FAHiB6B,EAAAC,QAAMC,IAC3B,GAAmBxB,OAAhBtB,EAAS,SAAgBsB,OAATvB,EAAI,OAAgFuB,OAA3EY,EAAW,kEAAwEZ,OAARa,EAAQ,iB,cAD3GQ,EAAQI,EAAAC,KAGRjC,EAAS4B,EAASM,KAExBpD,QAAQC,IAAIiB,G,SACCA,E,0EAIbE,EAAAC,GAASC,OAAOC,QACd,8D,2DAbiBiB,MAAAC,KAAAC,U,CA6DvB,SAAShB,EAAoB2B,GAC3B,IAAMC,EAASD,EACZE,KACC,SAAAC,G,IACEC,EAAYD,EAAZC,aACAC,EAAaF,EAAbE,cACAC,EAAIH,EAAJG,KACAC,EAAKJ,EAALI,MACAC,EAAKL,EAALK,MACAC,EAAQN,EAARM,SACAC,EAASP,EAATO,UAEA,MAAO,+CAC+CtC,OAA1CiC,EAAc,8BAAkDjC,OAAtBgC,EAAa,WAAyBhC,OAAhBkC,EAAK,aAGvClC,OAHkDkC,EAAK,8IAM5ClC,OAHXmC,EAAM,sHAMQnC,OAHHoC,EAAM,oIAMFpC,OAHDqC,EAAS,qIAGErC,OAAVsC,EAAU,8D,IAMtEC,KAAK,IACR5D,EAAQ6D,mBAAmB,YAAaX,E,CAS1CY,OAAO1D,iBAAiB,UAAU,WACXH,SAAS8D,gBAAgBC,wBAG7BC,OAAShE,SAAS8D,gBAAgBG,aAAe,MAChEtE,QAAQC,IAAI,QACZW,GAAQ,EAIRI,EAH8BT,EAAMO,MAAMC,OAGVH,EAnHpB,IAmHmCK,MAAK,SAAAC,GAClDQ,EAAoBR,EAAOS,MAC3BC,EAAsBC,UACtB,IAAM0C,EAAaC,KAAKC,KAAKvD,EAAOC,UAtH1B,IAuHVnB,QAAQC,IAAIsE,GACZvE,QAAQC,IAAIW,GACRA,IAAS2D,GAA6B,IAAfA,GAEzBnD,EAAAC,GAASC,OAAOC,QACd,6D","sources":["src/scroll.js"],"sourcesContent":["console.log('scroll');\nimport './sass/scroll.scss';\nimport Notiflix from 'notiflix';\n// console.log(Notiflix);\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n// console.log(SimpleLightbox);\nimport axios from 'axios';\n// console.log(axios);\n\nconst KEY = '32856813-557b11f28047fc34e33f2f2e2';\nconst BASE_URL = 'https://pixabay.com/api/';\n\nconst gallery = document.querySelector('.gallery');\nconst input = document.querySelector('input');\nconst searchForm = document.querySelector('#search-form');\n// const btnLoadMore = document.querySelector('.load-more');\n\n// btnLoadMore.addEventListener('click', onBtnLoadMore);\nsearchForm.addEventListener('submit', onSearchForm);\n\n//const gallerySimpleLightbox = new SimpleLightbox('.gallery a');\nconst gallerySimpleLightbox = new SimpleLightbox('.gallery a', {\n  captionsData: 'alt',\n  captionPosition: 'bottom',\n  captionDelay: 250,\n  scrollZoomFactor: 2,\n  //   navText: ['*', '*'],\n  overlayOpacity: 0.9,\n  fadeSpeed: 300,\n});\n\nlet searchRequest = '';\nlet page = 1;\nconst perPage = 40;\n// btnLoadMore.style.display = 'none';\n\nasync function getPhoto(inputValue, pageNum) {\n  try {\n    const response = await axios.get(\n      `${BASE_URL}?key=${KEY}&q=${inputValue}&image_type=photo&orientation=horizontal&safesearch=true&page=${pageNum}&per_page=40`\n    );\n    const images = response.data;\n    // console.log(images.hits);\n    console.log(images);\n    return await images;\n  } catch (error) {\n    // console.error(error);\n    //   throw new Error(console.log(error.message));\n    Notiflix.Notify.failure(\n      \"We're sorry, but you've reached the end of search results.\"\n    );\n  }\n}\n\nfunction onSearchForm(e) {\n  e.preventDefault();\n  clearGallery();\n  const searchRequest = input.value.trim();\n  //   const searchRequest = e.currentTarget.searchQuery.value.trim();\n  getPhoto(searchRequest, page).then(images => {\n    if (searchRequest === '' || images.totalHits === 0) {\n      return Notiflix.Notify.failure(\n        'Sorry, there are no images matching your search query. Please try again.'\n      );\n    } else {\n      Notiflix.Notify.success(`Hooray! We found ${images.totalHits} images.`);\n      renderMarkupGallery(images.hits);\n\n      //   btnLoadMore.style.display = 'block';\n      gallerySimpleLightbox.refresh();\n    }\n  });\n}\n\n// function onBtnLoadMore() {\n//   page += 1;\n//   btnLoadMore.style.display = 'none';\n//   //   gallerySimpleLightbox.destroy();\n//   const previousSearchRequest = input.value.trim();\n//   //console.log(previousSearchRequest);\n\n//   getPhoto(previousSearchRequest, page, perPage).then(images => {\n//     renderMarkupGallery(images.hits);\n//     gallerySimpleLightbox.refresh();\n//     const totalPages = Math.ceil(images.totalHits / perPage);\n//     console.log(totalPages);\n//     console.log(page);\n//     if (page === totalPages || totalPages === 1) {\n//     //   btnLoadMore.style.display = 'none';\n//       Notiflix.Notify.failure(\n//         \"We're sorry, but you've reached the end of search results.\"\n//       );\n//     }\n//   });\n// //   btnLoadMore.style.display = 'block';\n// }\n\nfunction renderMarkupGallery(arr) {\n  const markup = arr\n    .map(\n      ({\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) => {\n        return `<div class=\"photo-card\">\n         <a href=\"${largeImageURL}\"><img class=\"photo\" src=\"${webformatURL}\" alt=\"${tags}\" title=\"${tags}\" loading=\"lazy\"/></a>\n          <div class=\"info\">\n             <p class=\"info-item\">\n      <b>Likes</b> <span class=\"info-item-api\"> ${likes} </span>\n  </p>\n              <p class=\"info-item\">\n                  <b>Views</b> <span class=\"info-item-api\">${views}</span>\n              </p>\n              <p class=\"info-item\">\n                  <b>Comments</b> <span class=\"info-item-api\">${comments}</span>\n              </p>\n              <p class=\"info-item\">\n                  <b>Downloads</b> <span class=\"info-item-api\">${downloads}</span>\n              </p>\n          </div>\n      </div>`;\n      }\n    )\n    .join('');\n  gallery.insertAdjacentHTML('beforeend', markup);\n}\n\nfunction clearGallery() {\n  gallery.innerHTML = '';\n  page = 1;\n  //   btnLoadMore.style.display = 'none';\n}\n\nwindow.addEventListener('scroll', () => {\n  const documentRect = document.documentElement.getBoundingClientRect();\n  //   console.log('top', documentRect.top);\n  //   console.log('bottom', documentRect.bottom);\n  if (documentRect.bottom < document.documentElement.clientHeight + 150) {\n    console.log('DONE');\n    page += 1;\n    const previousSearchRequest = input.value.trim();\n    //   //console.log(previousSearchRequest);\n\n    getPhoto(previousSearchRequest, page, perPage).then(images => {\n      renderMarkupGallery(images.hits);\n      gallerySimpleLightbox.refresh();\n      const totalPages = Math.ceil(images.totalHits / perPage);\n      console.log(totalPages);\n      console.log(page);\n      if (page === totalPages || totalPages === 1) {\n        //   btnLoadMore.style.display = 'none';\n        Notiflix.Notify.failure(\n          \"We're sorry, but you've reached the end of search results.\"\n        );\n      }\n    });\n  }\n});\n"],"names":["$bpxeT","parcelRequire","console","log","$5b53d4e451fa0420$var$KEY","$5b53d4e451fa0420$var$BASE_URL","$5b53d4e451fa0420$var$gallery","document","querySelector","$5b53d4e451fa0420$var$input","addEventListener","e","preventDefault","innerHTML","$5b53d4e451fa0420$var$page","searchRequest1","value","trim","$5b53d4e451fa0420$var$getPhoto","then","images","totalHits","$parcel$interopDefault","$6JpON","Notify","failure","success","concat","$5b53d4e451fa0420$var$renderMarkupGallery","hits","$5b53d4e451fa0420$var$gallerySimpleLightbox","refresh","$5IjG7","captionsData","captionPosition","captionDelay","scrollZoomFactor","overlayOpacity","fadeSpeed","inputValue","pageNum","$5b53d4e451fa0420$var$_getPhoto","apply","this","arguments","$2TvXO","mark","_callee","response","$dIxxU","default","get","_ctx","sent","data","arr","markup","map","param","webformatURL","largeImageURL","tags","likes","views","comments","downloads","join","insertAdjacentHTML","window","documentElement","getBoundingClientRect","bottom","clientHeight","totalPages","Math","ceil"],"version":3,"file":"scroll.b2c709b7.js.map"}